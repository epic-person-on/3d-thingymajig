// Initialize the scene, camera, and renderer
var scene = new THREE.Scene();
// Set the background color of the scene
var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
var renderer = new THREE.WebGLRenderer({canvas: document.getElementById('myCanvas'), antialias: true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Add a background to the scene
var texture = new THREE.TextureLoader().load(src="data:image/jpeg;base64,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");
texture.wrapS = THREE.RepeatWrapping;
texture.wrapT = THREE.RepeatWrapping;
texture.repeat.set(4, 4); // adjust the repeat factor to fit your image

var textureCube = new THREE.CubeTexture([
    texture, texture, texture, texture, texture, texture
]);
scene.background = textureCube;

// Create a cube with outlines
var geometry = new THREE.BoxGeometry();
var material = new THREE.MeshBasicMaterial({color: 0x00ff00});
var edges = new THREE.EdgesGeometry(geometry);
var lineMaterial = new THREE.LineBasicMaterial({color: 0x000000});
var cube = new THREE.LineSegments(edges, lineMaterial);
cube.add(new THREE.Mesh(geometry, material));
scene.add(cube);




// Position the camera and set the initial rotation and direction
camera.position.set(0, 0, 5);
var direction = new THREE.Vector3(0, 0, -1);
var rotation = new THREE.Vector2(0, 0);

// Add keyboard controls
var keyboard = {};
function onKeyDown(event) {
	keyboard[event.code] = true;
}
function onKeyUp(event) {
	keyboard[event.code] = false;
}
document.addEventListener('keydown', onKeyDown);
document.addEventListener('keyup', onKeyUp);

// Animate the cube and render the scene
function animate() {
	requestAnimationFrame(animate);
	
	// Move the cube based on keyboard input
	var speed = 0.1;
	if (keyboard['KeyW']) {
		cube.position.add(direction.clone().multiplyScalar(-speed));
	}
	if (keyboard['KeyA']) {
		cube.position.add(new THREE.Vector3(-direction.z, 0, direction.x).normalize().multiplyScalar(speed));
	}
	if (keyboard['KeyS']) {
		cube.position.add(direction.clone().multiplyScalar(speed));
	}
	if (keyboard['KeyD']) {
		cube.position.add(new THREE.Vector3(direction.z, 0, -direction.x).normalize().multiplyScalar(speed));
	}
	
	// Rotate the camera smoothly based on keyboard input
	var delta = 0.02;
	if (keyboard['KeyE']) {
		rotation.x -= delta;
	}
	if (keyboard['KeyQ']) {
		rotation.x += delta;
	}
	camera.rotation.set(rotation.y, rotation.x, 0);
	direction.set(0, 0, -1).applyQuaternion(camera.quaternion);
	
	renderer.render(scene, camera);
}
animate();
